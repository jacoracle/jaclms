<div class="main-container-br">

  <div [ngSwitch]="isAuthenticated()" *jhiHasAnyAuthority="'ROLE_USER'" class="window-br">
    <!-- Window Header -->
    <div class="window-br-header">
      <div class="alert-home-uma">
        <jhi-alert-error></jhi-alert-error>
      </div>
      <div class="r1">
        <div class="logo-create"></div>
      </div>
      <div class="r2">
        <div class="windowHeader-title"><i class="icon whBook"></i>
          <h4>Unidades Mínimas de Aprendizaje</h4>
        </div>
        <div class="c1">
          <div class="button-hc"><i class="icon ni-support"></i>Soporte</div>
          <div class="button-hc"><i class="icon ni-help"></i>Ayuda</div>
        </div>
      </div>
    </div>

    <div [hidden]="!showLoader" class="loader-home">
      <span class="loader"></span>
    </div>

    <div class="window-br-body-topbar recent-modules">
      <div class="line-gradient"></div>
      <div class="row-wbr-bt" *ngIf="modulos.length || isSearching">
        <p>Tus UMA's recientes ( {{modulos.length}} )</p>
      </div>
    </div>

    <!-- Window Empty -->
    <div class="window-br-body" *ngIf="!modulos.length && !isSearching">
      <div class="container-br-message">
        <div class="br-message">
          <div class="brm-1">
            <div class="br-message-icon"></div>
          </div>
          <div class="brm-2">
            <p>¡Hola! <br> Bienvenido a <span>Nimbus Constructor</span>.</p>
            <p>Para comenzar da click en el botón "Crear UMA".</p>
          </div>
        </div>
      </div>
    </div>
    <!-- Window content Module -->
    <div class="window-br-body" *ngIf="modulos.length || isSearching">

      <!-- search box -->

      <div class="search-main-container">
        <form name="umaForm" role="form" [formGroup]="umaForm" autocomplete="off">
          <div class="container-search-form-uma">
            <div class="row-search-gral">
            </div>

            <div class="row-search-gral">
              <mat-form-field>
                <mat-label>Búsqueda general por título</mat-label>
                <input type="text" placeholder="indicio del posible título" matInput formControlName="titleSearchGral"
                  [matAutocomplete]="autoInputTitleSearch">
                <mat-autocomplete autoActiveFirstOption #autoInputTitleSearch="matAutocomplete"
                  [displayWith]="displayFn">
                  <!-- <mat-option *ngFor="let option of filteredTypeOpts | async" [value]="option"> -->
                  <mat-option *ngFor="let option of modulos" [value]="option">
                    {{option.descripcion}}
                  </mat-option>
                </mat-autocomplete>
              </mat-form-field>
            </div>

            <div class="container-field-filter">
              <p>Filtrar por:</p>

              <div class="row-filter-uma">
                <mat-form-field>
                  <mat-label>Título de la UMA</mat-label>
                  <input matInput formControlName="umaTitleFormCtrl" placeholder="filtrar por título del UMA">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>Descripción UMA</mat-label>
                  <input matInput formControlName="umaDescriptionFormCtrl" placeholder="filtrar por descripción">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>Área de conocimiento</mat-label>
                  <input type="text" placeholder="indicio de del área de conocimiento" matInput
                    formControlName="umaAreaKnowledgeFormCtrl">
                </mat-form-field>
              </div>

              <div class="row-filter-uma">
                <mat-form-field>
                  <mat-label>Nivel Académico</mat-label>
                  <input type="text" placeholder="filtrar por nivel académico" matInput
                    formControlName="academicGradeFormCtrl">
                </mat-form-field>

                <mat-form-field>
                  <mat-label>Tema del UMA</mat-label>
                  <input type="text" placeholder="filtrar por tema" matInput formControlName="sessionTopicFormCtrl">
                </mat-form-field>
              </div>
            </div>

          </div>


          <div class="btn-search-group">
            <button class="secondary-btn" (click)="resetUmas()" type="button">
              Limpiar
            </button>
            <button type="button" class="main-btn" (click)="executeSearch()">
              Buscar
            </button>
          </div>



        </form>

      </div>

      <!-- end search box -->
      <div class="result-search-container">
        <div class="grid-cards">

          <div class="course-cover-br box-card" *ngFor="let modulo of modulos"
            [routerLink]="['/constructor-layout', modulo.id, 'module']">
            <!-- <div class="course-cover-br box-card" *ngFor="let modulo of filteredUmas | async"
          [routerLink]="['/constructor-layout', modulo.id, 'module']"> -->

            <div class="module-cover-br-image"></div>

            <div (click)="deleteModule(modulo.id, $event)" class="delete-course-br">
              <i class="icon ni-delete icon-negative"></i>
            </div>

            <div class="course-desc-br-row">
              <span class="title-course-br"
                *ngIf="modulo.titulo">{{modulo.titulo.length > 30 ? modulo.titulo.substring(0, 30) + "..." : modulo.titulo}}</span>
              <span class="desc-course-br"
                *ngIf="modulo.descripcion">{{modulo.descripcion.length > 30 ? modulo.descripcion.substring(0, 30) + "..." : modulo.descripcion}}</span>
            </div>

          </div>

        </div>
      </div>


    </div>

    <div class="window-br-footer">
      <button routerLink="/" class="secondary-btn">Regresar</button>
      <button routerLink="/uma-configuration" class="main-btn">Crear UMA</button>
    </div>

  </div>

</div>
